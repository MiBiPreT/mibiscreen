
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Prediction tool for Microbiome based Remediation">
      
      
        <meta name="author" content="Alraune Zech, Sona Aseyednezhad, Robin Richardson, Jaro Camphuijsen">
      
      
        <link rel="canonical" href="https://MiBiPreT.github.io/mibiscreen/reference/reference_analysis/">
      
      
        <link rel="prev" href="../reference_data/">
      
      
        <link rel="next" href="../reference_visualize/">
      
      
      <link rel="icon" href="../../assets/icon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Analysis - mibiscreen</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../assets/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mibiscreenanalysis-api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="mibiscreen" class="md-header__button md-logo" aria-label="mibiscreen" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mibiscreen
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Analysis
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/MiBiPreT/mibiscreen" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    MiBiPreT/mibiscreen
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../introduction/introduction/" class="md-tabs__link">
        
  
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../application/data_pipeline_template/" class="md-tabs__link">
          
  
  
    
  
  Application

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../methods/overview/" class="md-tabs__link">
          
  
  
    
  
  Methods

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../application/data_pipeline_template/" class="md-tabs__link">
          
  
  
    
  
  Application

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../development/development/" class="md-tabs__link">
        
  
  
    
  
  Development

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../reference_data/" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="mibiscreen" class="md-nav__button md-logo" aria-label="mibiscreen" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    mibiscreen
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/MiBiPreT/mibiscreen" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    MiBiPreT/mibiscreen
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Application
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Application
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../application/data_pipeline_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Methods
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Methods
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methods/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methods/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methods/na_screening/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NA Screening
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methods/concentrations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concentrations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methods/ordination/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ordination
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methods/stable_isotopes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stable Isotope Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Application
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Application
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../application/data_pipeline_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Analysis
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Analysis
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mibiscreen.analysis" class="md-nav__link">
    <span class="md-ellipsis">
      analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction" class="md-nav__link">
    <span class="md-ellipsis">
      reduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination" class="md-nav__link">
    <span class="md-ellipsis">
      ordination
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ordination">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.cca" class="md-nav__link">
    <span class="md-ellipsis">
      cca
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cca">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.cca--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.cca--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.constrained_ordination" class="md-nav__link">
    <span class="md-ellipsis">
      constrained_ordination
    </span>
  </a>
  
    <nav class="md-nav" aria-label="constrained_ordination">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.constrained_ordination--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.constrained_ordination--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.extract_variables" class="md-nav__link">
    <span class="md-ellipsis">
      extract_variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.extract_variables--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.extract_variables--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.pca" class="md-nav__link">
    <span class="md-ellipsis">
      pca
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pca">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.pca--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.pca--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.rda" class="md-nav__link">
    <span class="md-ellipsis">
      rda
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rda">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.rda--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.rda--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression" class="md-nav__link">
    <span class="md-ellipsis">
      stable_isotope_regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="stable_isotope_regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Keeling_regression" class="md-nav__link">
    <span class="md-ellipsis">
      Keeling_regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Keeling_regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Keeling_regression--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Keeling_regression--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Lambda_regression" class="md-nav__link">
    <span class="md-ellipsis">
      Lambda_regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lambda_regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Lambda_regression--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Lambda_regression--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation" class="md-nav__link">
    <span class="md-ellipsis">
      Rayleigh_fractionation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rayleigh_fractionation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.extract_isotope_data" class="md-nav__link">
    <span class="md-ellipsis">
      extract_isotope_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_isotope_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.extract_isotope_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.extract_isotope_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.valid_indices" class="md-nav__link">
    <span class="md-ellipsis">
      valid_indices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="valid_indices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.valid_indices--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.valid_indices--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.transformation" class="md-nav__link">
    <span class="md-ellipsis">
      transformation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="transformation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.transformation.filter_values" class="md-nav__link">
    <span class="md-ellipsis">
      filter_values
    </span>
  </a>
  
    <nav class="md-nav" aria-label="filter_values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.transformation.filter_values--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.transformation.filter_values--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.transformation.transform_values" class="md-nav__link">
    <span class="md-ellipsis">
      transform_values
    </span>
  </a>
  
    <nav class="md-nav" aria-label="transform_values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.transformation.transform_values--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.transformation.transform_values--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations" class="md-nav__link">
    <span class="md-ellipsis">
      concentrations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="concentrations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.thresholds_for_intervention" class="md-nav__link">
    <span class="md-ellipsis">
      thresholds_for_intervention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="thresholds_for_intervention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.thresholds_for_intervention--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.thresholds_for_intervention--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_concentration" class="md-nav__link">
    <span class="md-ellipsis">
      total_concentration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="total_concentration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_concentration--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_concentration--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_contaminant_concentration" class="md-nav__link">
    <span class="md-ellipsis">
      total_contaminant_concentration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="total_contaminant_concentration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_contaminant_concentration--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_contaminant_concentration--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_count" class="md-nav__link">
    <span class="md-ellipsis">
      total_count
    </span>
  </a>
  
    <nav class="md-nav" aria-label="total_count">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_count--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_count--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.properties" class="md-nav__link">
    <span class="md-ellipsis">
      properties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA" class="md-nav__link">
    <span class="md-ellipsis">
      screening_NA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="screening_NA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.electron_balance" class="md-nav__link">
    <span class="md-ellipsis">
      electron_balance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="electron_balance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.electron_balance--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.electron_balance--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.oxidators" class="md-nav__link">
    <span class="md-ellipsis">
      oxidators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="oxidators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.oxidators--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.oxidators--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.reductors" class="md-nav__link">
    <span class="md-ellipsis">
      reductors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reductors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.reductors--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.reductors--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.sample_NA_screening" class="md-nav__link">
    <span class="md-ellipsis">
      sample_NA_screening
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample_NA_screening">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.sample_NA_screening--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.sample_NA_traffic" class="md-nav__link">
    <span class="md-ellipsis">
      sample_NA_traffic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample_NA_traffic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.sample_NA_traffic--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.sample_NA_traffic--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_visualize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualize
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mibiscreen.analysis" class="md-nav__link">
    <span class="md-ellipsis">
      analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction" class="md-nav__link">
    <span class="md-ellipsis">
      reduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination" class="md-nav__link">
    <span class="md-ellipsis">
      ordination
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ordination">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.cca" class="md-nav__link">
    <span class="md-ellipsis">
      cca
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cca">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.cca--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.cca--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.constrained_ordination" class="md-nav__link">
    <span class="md-ellipsis">
      constrained_ordination
    </span>
  </a>
  
    <nav class="md-nav" aria-label="constrained_ordination">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.constrained_ordination--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.constrained_ordination--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.extract_variables" class="md-nav__link">
    <span class="md-ellipsis">
      extract_variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.extract_variables--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.extract_variables--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.pca" class="md-nav__link">
    <span class="md-ellipsis">
      pca
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pca">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.pca--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.pca--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.rda" class="md-nav__link">
    <span class="md-ellipsis">
      rda
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rda">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.rda--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.ordination.rda--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression" class="md-nav__link">
    <span class="md-ellipsis">
      stable_isotope_regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="stable_isotope_regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Keeling_regression" class="md-nav__link">
    <span class="md-ellipsis">
      Keeling_regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Keeling_regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Keeling_regression--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Keeling_regression--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Lambda_regression" class="md-nav__link">
    <span class="md-ellipsis">
      Lambda_regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lambda_regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Lambda_regression--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Lambda_regression--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation" class="md-nav__link">
    <span class="md-ellipsis">
      Rayleigh_fractionation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rayleigh_fractionation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.extract_isotope_data" class="md-nav__link">
    <span class="md-ellipsis">
      extract_isotope_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_isotope_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.extract_isotope_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.extract_isotope_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.valid_indices" class="md-nav__link">
    <span class="md-ellipsis">
      valid_indices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="valid_indices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.valid_indices--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.stable_isotope_regression.valid_indices--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.transformation" class="md-nav__link">
    <span class="md-ellipsis">
      transformation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="transformation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.transformation.filter_values" class="md-nav__link">
    <span class="md-ellipsis">
      filter_values
    </span>
  </a>
  
    <nav class="md-nav" aria-label="filter_values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.transformation.filter_values--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.transformation.filter_values--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.transformation.transform_values" class="md-nav__link">
    <span class="md-ellipsis">
      transform_values
    </span>
  </a>
  
    <nav class="md-nav" aria-label="transform_values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.transformation.transform_values--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.reduction.transformation.transform_values--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations" class="md-nav__link">
    <span class="md-ellipsis">
      concentrations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="concentrations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.thresholds_for_intervention" class="md-nav__link">
    <span class="md-ellipsis">
      thresholds_for_intervention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="thresholds_for_intervention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.thresholds_for_intervention--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.thresholds_for_intervention--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_concentration" class="md-nav__link">
    <span class="md-ellipsis">
      total_concentration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="total_concentration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_concentration--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_concentration--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_contaminant_concentration" class="md-nav__link">
    <span class="md-ellipsis">
      total_contaminant_concentration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="total_contaminant_concentration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_contaminant_concentration--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_contaminant_concentration--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_count" class="md-nav__link">
    <span class="md-ellipsis">
      total_count
    </span>
  </a>
  
    <nav class="md-nav" aria-label="total_count">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_count--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.concentrations.total_count--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.properties" class="md-nav__link">
    <span class="md-ellipsis">
      properties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA" class="md-nav__link">
    <span class="md-ellipsis">
      screening_NA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="screening_NA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.electron_balance" class="md-nav__link">
    <span class="md-ellipsis">
      electron_balance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="electron_balance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.electron_balance--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.electron_balance--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.oxidators" class="md-nav__link">
    <span class="md-ellipsis">
      oxidators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="oxidators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.oxidators--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.oxidators--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.reductors" class="md-nav__link">
    <span class="md-ellipsis">
      reductors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reductors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.reductors--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.reductors--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.sample_NA_screening" class="md-nav__link">
    <span class="md-ellipsis">
      sample_NA_screening
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample_NA_screening">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.sample_NA_screening--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.sample_NA_traffic" class="md-nav__link">
    <span class="md-ellipsis">
      sample_NA_traffic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample_NA_traffic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.sample_NA_traffic--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiscreen.analysis.sample.screening_NA.sample_NA_traffic--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="mibiscreenanalysis-api-reference"><code>mibiscreen.analysis</code> API reference</h1>


<div class="doc doc-object doc-module">



<a id="mibiscreen.analysis"></a>
    <div class="doc doc-contents first">

        <p>mibiscreen module for data analysis.</p>








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h2 id="mibiscreen.analysis.reduction" class="doc doc-heading">
            <code>reduction</code>


</h2>

    <div class="doc doc-contents ">

        <p>mibiscreen module for data analysis reducing sample data.</p>








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="mibiscreen.analysis.reduction.ordination" class="doc doc-heading">
            <code>ordination</code>


</h3>

    <div class="doc doc-contents ">

        <p>Routines for performing ordination statistics on sample data.</p>
<p>@author: Alraune Zech, Jorrit Bakker</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.reduction.ordination.cca" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cca</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">independent_variables</span><span class="p">,</span> <span class="n">dependent_variables</span><span class="p">,</span> <span class="n">n_comp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function that performs Canonical Correspondence Analysis.</p>
<p>Function makes use of skbio.stats.ordination.CCA on the input data and gives
the site scores and loadings.</p>
<h6 id="mibiscreen.analysis.reduction.ordination.cca--input">Input</h6>
<div class="highlight"><pre><span></span><code>data_frame : pd.dataframe
    Tabular data containing variables to be evaluated with standard
    column names and rows of sample data.
independent_variables : list of strings
    list with column names data to be the independent variables (=environment)
dependent_variables : list of strings
    list with column names data to be the dependen variables (=species)
n_comp : int, default is 2
    number of dimensions to return
verbose : Boolean, The default is False.
    Set to True to get messages in the Console about the status of the run code.
</code></pre></div>
<h6 id="mibiscreen.analysis.reduction.ordination.cca--output">Output</h6>
<div class="highlight"><pre><span></span><code>results : Dictionary
    * method: name of ordination method (str)
    * loadings_independent: loadings of independent variables (np.ndarray)
    * loadings_dependent: loadings of dependent variables (np.ndarray)
    * names_independent: names of independent varialbes (list of str)
    * names_dependent: names of dependent varialbes (list of str)
    * scores: scores (np.ndarray)
    * sample_index: names of samples (list of str)
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/reduction/ordination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="k">def</span><span class="w"> </span><span class="nf">cca</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">n_comp</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="p">):</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function that performs Canonical Correspondence Analysis.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    Function makes use of skbio.stats.ordination.CCA on the input data and gives</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    the site scores and loadings.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Input</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    -----</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        data_frame : pd.dataframe</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            Tabular data containing variables to be evaluated with standard</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            column names and rows of sample data.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        independent_variables : list of strings</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            list with column names data to be the independent variables (=environment)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        dependent_variables : list of strings</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            list with column names data to be the dependen variables (=species)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        n_comp : int, default is 2</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            number of dimensions to return</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        verbose : Boolean, The default is False.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">            Set to True to get messages in the Console about the status of the run code.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    Output</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    ------</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        results : Dictionary</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            * method: name of ordination method (str)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            * loadings_independent: loadings of independent variables (np.ndarray)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            * loadings_dependent: loadings of dependent variables (np.ndarray)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            * names_independent: names of independent varialbes (list of str)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            * names_dependent: names of dependent varialbes (list of str)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            * scores: scores (np.ndarray)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            * sample_index: names of samples (list of str)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;cca()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">results</span> <span class="o">=</span> <span class="n">constrained_ordination</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>                           <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>                           <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                           <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;cca&#39;</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                           <span class="n">n_comp</span> <span class="o">=</span> <span class="n">n_comp</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                           <span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.reduction.ordination.constrained_ordination" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">constrained_ordination</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">independent_variables</span><span class="p">,</span> <span class="n">dependent_variables</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cca&#39;</span><span class="p">,</span> <span class="n">n_comp</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function that performs constrained ordination.</p>
<p>Function makes use of skbio.stats.ordination on the input data and gives
the scores and loadings.</p>
<h6 id="mibiscreen.analysis.reduction.ordination.constrained_ordination--input">Input</h6>
<div class="highlight"><pre><span></span><code>data_frame : pd.DataFrame
    Tabular data containing variables to be evaluated with standard
    column names and rows of sample data.
independent_variables : list of strings
   list with column names data to be the independent variables (=environment)
dependent_variables : list of strings
   list with column names data to be the dependen variables (=species)
method : string, default is cca
    specification of ordination method of choice. Options &#39;cca&#39; &amp; &#39;rda&#39;
n_comp : int, default is 2
    number of dimensions to return
</code></pre></div>
<h6 id="mibiscreen.analysis.reduction.ordination.constrained_ordination--output">Output</h6>
<div class="highlight"><pre><span></span><code>results : Dictionary
    * method: name of ordination method (str)
    * loadings_independent: loadings of independent variables (np.ndarray)
    * loadings_dependent: loadings of dependent variables (np.ndarray)
    * names_independent: names of independent varialbes (list of str)
    * names_dependent: names of dependent varialbes (list of str)
    * scores: scores (np.ndarray)
    * sample_index: names of samples (list of str)
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/reduction/ordination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="k">def</span><span class="w"> </span><span class="nf">constrained_ordination</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>                           <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>                           <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>                           <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;cca&#39;</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>                           <span class="n">n_comp</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="p">):</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function that performs constrained ordination.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    Function makes use of skbio.stats.ordination on the input data and gives</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    the scores and loadings.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    Input</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    -----</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        data_frame : pd.DataFrame</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">            Tabular data containing variables to be evaluated with standard</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            column names and rows of sample data.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        independent_variables : list of strings</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">           list with column names data to be the independent variables (=environment)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        dependent_variables : list of strings</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">           list with column names data to be the dependen variables (=species)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        method : string, default is cca</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            specification of ordination method of choice. Options &#39;cca&#39; &amp; &#39;rda&#39;</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        n_comp : int, default is 2</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">            number of dimensions to return</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    Output</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    ------</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        results : Dictionary</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">            * method: name of ordination method (str)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">            * loadings_independent: loadings of independent variables (np.ndarray)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">            * loadings_dependent: loadings of dependent variables (np.ndarray)</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">            * names_independent: names of independent varialbes (list of str)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">            * names_dependent: names of dependent varialbes (list of str)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">            * scores: scores (np.ndarray)</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">            * sample_index: names of samples (list of str)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">)</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="n">intersection</span> <span class="o">=</span> <span class="n">extract_variables</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>                          <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>                          <span class="n">name_variables</span> <span class="o">=</span> <span class="s1">&#39;independent variables&#39;</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                          <span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="n">data_independent_variables</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">intersection</span><span class="p">]</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="n">intersection</span> <span class="o">=</span> <span class="n">extract_variables</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>                          <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>                          <span class="n">name_variables</span> <span class="o">=</span> <span class="s1">&#39;dependent variables&#39;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>                          <span class="p">)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">data_dependent_variables</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">intersection</span><span class="p">]</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="c1"># Checking if the dimensions of the dataframe allow for CCA</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">data_dependent_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">data_dependent_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> \
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="p">(</span><span class="n">data_independent_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">data_independent_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Ordination method </span><span class="si">{}</span><span class="s2"> not possible with more variables than samples.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="p">))</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="c1"># Performing constrained ordination using function from scikit-bio.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;cca&#39;</span><span class="p">:</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>            <span class="n">sci_ordination</span> <span class="o">=</span> <span class="n">sciord</span><span class="o">.</span><span class="n">cca</span><span class="p">(</span><span class="n">data_dependent_variables</span><span class="p">,</span> <span class="n">data_independent_variables</span><span class="p">,</span> <span class="n">scaling</span> <span class="o">=</span> <span class="n">n_comp</span><span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="k">except</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span><span class="ne">ValueError</span><span class="p">):</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Not all column values are numeric values. Consider standardizing data first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;rda&#39;</span><span class="p">:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>            <span class="n">sci_ordination</span> <span class="o">=</span> <span class="n">sciord</span><span class="o">.</span><span class="n">rda</span><span class="p">(</span><span class="n">data_dependent_variables</span><span class="p">,</span> <span class="n">data_independent_variables</span><span class="p">,</span> <span class="n">scaling</span> <span class="o">=</span> <span class="n">n_comp</span><span class="p">)</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="k">except</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span><span class="ne">ValueError</span><span class="p">):</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Not all column values are numeric values. Consider standardizing data first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Ordination method </span><span class="si">{}</span><span class="s2"> not a valid option.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="p">))</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="n">loadings_independent</span> <span class="o">=</span> <span class="n">sci_ordination</span><span class="o">.</span><span class="n">biplot_scores</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">n_comp</span><span class="p">]</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="n">loadings_dependent</span> <span class="o">=</span> <span class="n">sci_ordination</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">n_comp</span><span class="p">]</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">scores</span> <span class="o">=</span> <span class="n">sci_ordination</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">n_comp</span><span class="p">]</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="k">if</span> <span class="n">loadings_independent</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="n">n_comp</span><span class="p">:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of dependent variables too small.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>               <span class="s2">&quot;loadings_dependent&quot;</span><span class="p">:</span> <span class="n">loadings_dependent</span><span class="p">,</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>               <span class="s2">&quot;loadings_independent&quot;</span><span class="p">:</span> <span class="n">loadings_independent</span><span class="p">,</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>               <span class="s2">&quot;names_independent&quot;</span> <span class="p">:</span> <span class="n">data_independent_variables</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>               <span class="s2">&quot;names_dependent&quot;</span> <span class="p">:</span> <span class="n">data_dependent_variables</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>               <span class="s2">&quot;scores&quot;</span><span class="p">:</span> <span class="n">scores</span><span class="p">,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>               <span class="s2">&quot;sample_index&quot;</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>               <span class="p">}</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.reduction.ordination.extract_variables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_variables</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">name_variables</span><span class="o">=</span><span class="s1">&#39;variables&#39;</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checking overlap of two given list.</p>
<p>Function is used for checking if a list of variables is present in
the column names of a given dataframe (of quantities for data analysis)</p>
<h6 id="mibiscreen.analysis.reduction.ordination.extract_variables--input">Input</h6>
<div class="highlight"><pre><span></span><code>columns: list of strings
    given extensive list (usually column names of a pd.DataFrame)
variables: list of strings
    list of names to extract/check overlap with strings in list &#39;column&#39;
name_variables: str, default is &#39;variables&#39;
    name of type of variables given in list &#39;variables&#39;
</code></pre></div>
<h6 id="mibiscreen.analysis.reduction.ordination.extract_variables--output">Output</h6>
<div class="highlight"><pre><span></span><code>intersection: list
    list of strings present in both lists &#39;columns&#39; and &#39;variables&#39;
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/reduction/ordination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_variables</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>                      <span class="n">variables</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>                      <span class="n">name_variables</span> <span class="o">=</span> <span class="s1">&#39;variables&#39;</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>                      <span class="p">):</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checking overlap of two given list.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    Function is used for checking if a list of variables is present in</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    the column names of a given dataframe (of quantities for data analysis)</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">    Input</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    -----</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        columns: list of strings</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">            given extensive list (usually column names of a pd.DataFrame)</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        variables: list of strings</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">            list of names to extract/check overlap with strings in list &#39;column&#39;</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">        name_variables: str, default is &#39;variables&#39;</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">            name of type of variables given in list &#39;variables&#39;</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">    Output</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">    ------</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        intersection: list</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">            list of strings present in both lists &#39;columns&#39; and &#39;variables&#39;</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="n">intersection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">variables</span><span class="p">))</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="n">remainder</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">columns</span><span class="p">))</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No column names for &#39;</span><span class="si">{}</span><span class="s2">&#39; identified in columns of dataframe.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_variables</span><span class="p">))</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: not all column names for &#39;</span><span class="si">{}</span><span class="s2">&#39; are found in dataframe.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_variables</span><span class="p">))</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columns used in analysis:&quot;</span><span class="p">,</span> <span class="n">intersection</span><span class="p">)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Column names not identified in data:&quot;</span><span class="p">,</span> <span class="n">remainder</span><span class="p">)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;List of column names for &#39;</span><span class="si">{}</span><span class="s2">&#39; empty or in wrong format.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_variables</span><span class="p">))</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="k">return</span> <span class="n">intersection</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.reduction.ordination.pca" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pca</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">independent_variables</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dependent_variables</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_comp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function that performs Principal Component Analysis.</p>
<p>Makes use of routine sklearn.decomposition.PCA on the input data and gives
the site scores and loadings.</p>
<p>Principal component analysis (PCA) is a linear dimensionality reduction
technique with applications in exploratory data analysis, visualization
and data preprocessing. The data is linearly transformed onto a new
coordinate system such that the directions (principal components) capturing
the largest variation in the data can be easily identified.</p>
<h6 id="mibiscreen.analysis.reduction.ordination.pca--input">Input</h6>
<div class="highlight"><pre><span></span><code>data_frame : pd.dataframe
    Tabular data containing variables to be evaluated with standard
    column names and rows of sample data.
independent_variables : Boolean or list of strings; default False
    list with column names to select from data_frame
    being characterized as independent variables (= environment)
dependent_variables : Boolean or list of strings; default is False
    list with column names to select from data_frame
    being characterized as dependent variables (= species)
n_comp : int, default is 2
    Number of components to report
verbose : Boolean, The default is False.
   Set to True to get messages in the Console about the status of the run code.
</code></pre></div>
<h6 id="mibiscreen.analysis.reduction.ordination.pca--output">Output</h6>
<div class="highlight"><pre><span></span><code>results : Dictionary
    containing the scores and loadings of the PCA,
    the percentage of the variation explained by the first principal components,
    the correlation coefficient between the first two PCs,
    names of columns (same length as loadings)
    names of indices (same length as scores)
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/reduction/ordination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">pca</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="n">independent_variables</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>        <span class="n">dependent_variables</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>        <span class="n">n_comp</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="p">):</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function that performs Principal Component Analysis.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    Makes use of routine sklearn.decomposition.PCA on the input data and gives</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    the site scores and loadings.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Principal component analysis (PCA) is a linear dimensionality reduction</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    technique with applications in exploratory data analysis, visualization</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    and data preprocessing. The data is linearly transformed onto a new</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    coordinate system such that the directions (principal components) capturing</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    the largest variation in the data can be easily identified.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    Input</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    -----</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        data_frame : pd.dataframe</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">            Tabular data containing variables to be evaluated with standard</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">            column names and rows of sample data.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        independent_variables : Boolean or list of strings; default False</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">            list with column names to select from data_frame</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            being characterized as independent variables (= environment)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        dependent_variables : Boolean or list of strings; default is False</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">            list with column names to select from data_frame</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">            being characterized as dependent variables (= species)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        n_comp : int, default is 2</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">            Number of components to report</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        verbose : Boolean, The default is False.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">           Set to True to get messages in the Console about the status of the run code.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    Output</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    ------</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        results : Dictionary</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">            containing the scores and loadings of the PCA,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            the percentage of the variation explained by the first principal components,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">            the correlation coefficient between the first two PCs,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">            names of columns (same length as loadings)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">            names of indices (same length as scores)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;pca()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="k">if</span> <span class="n">independent_variables</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">dependent_variables</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="n">data_pca</span> <span class="o">=</span> <span class="n">data</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">names_independent</span> <span class="o">=</span> <span class="n">cols</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">names_dependent</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="k">elif</span> <span class="n">independent_variables</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">dependent_variables</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">names_independent</span> <span class="o">=</span> <span class="n">extract_variables</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>                              <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>                              <span class="n">name_variables</span> <span class="o">=</span> <span class="s1">&#39;independent variables&#39;</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>                              <span class="p">)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">names_dependent</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">data_pca</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">names_independent</span><span class="p">]</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="k">elif</span> <span class="n">independent_variables</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">dependent_variables</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">names_dependent</span> <span class="o">=</span> <span class="n">extract_variables</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                              <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>                              <span class="n">name_variables</span> <span class="o">=</span> <span class="s1">&#39;dependent variables&#39;</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>                              <span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="n">names_independent</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">data_pca</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">names_dependent</span><span class="p">]</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="n">names_independent</span> <span class="o">=</span> <span class="n">extract_variables</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>                              <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>                              <span class="n">name_variables</span> <span class="o">=</span> <span class="s1">&#39;independent variables&#39;</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                              <span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="n">names_dependent</span> <span class="o">=</span> <span class="n">extract_variables</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                              <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                              <span class="n">name_variables</span> <span class="o">=</span> <span class="s1">&#39;dependent variables&#39;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>                              <span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="n">data_pca</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">names_independent</span> <span class="o">+</span> <span class="n">names_dependent</span><span class="p">]</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="c1"># Checking if the dimensions of the dataframe allow for PCA</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="k">if</span> <span class="n">data_pca</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">data_pca</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;PCA not possible with more variables than samples.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="c1"># Using scikit.decomposoition.PCA with an amount of components equal</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="c1"># to the amount of variables, then getting the loadings, scores and explained variance ratio.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="n">pca</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data_pca</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_pca</span><span class="p">)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="n">loadings</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">PCAscores</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">data_pca</span><span class="p">)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">variances</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">except</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span><span class="ne">TypeError</span><span class="p">):</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Not all column values are numeric values (or NaN). Consider standardizing data first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="c1"># Taking the first two PC for plotting</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="k">if</span> <span class="n">dependent_variables</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="n">loadings_independent</span> <span class="o">=</span> <span class="n">loadings</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">n_comp</span><span class="p">]</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">loadings_dependent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[],[]])</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">loadings_independent</span> <span class="o">=</span> <span class="n">loadings</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">names_dependent</span><span class="p">),</span> <span class="mi">0</span><span class="p">:</span><span class="n">n_comp</span><span class="p">]</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">loadings_dependent</span> <span class="o">=</span> <span class="n">loadings</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">names_dependent</span><span class="p">):,</span> <span class="mi">0</span><span class="p">:</span><span class="n">n_comp</span><span class="p">]</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">scores</span> <span class="o">=</span> <span class="n">PCAscores</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">n_comp</span><span class="p">]</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">percent_explained</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">variances</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">variances</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">coef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">scores</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">scores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Information about the success of the PCA:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">percent_explained</span><span class="p">)):</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Principle component </span><span class="si">{}</span><span class="s1"> explains </span><span class="si">{}% o</span><span class="s1">f the total variance.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">percent_explained</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The correlation coefficient between PC1 and PC2 is </span><span class="si">{:.2e}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coef</span><span class="p">))</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s1">&#39;pca&#39;</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>               <span class="s2">&quot;loadings_dependent&quot;</span><span class="p">:</span> <span class="n">loadings_dependent</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>               <span class="s2">&quot;loadings_independent&quot;</span><span class="p">:</span> <span class="n">loadings_independent</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>               <span class="s2">&quot;names_independent&quot;</span> <span class="p">:</span> <span class="n">names_independent</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>               <span class="s2">&quot;names_dependent&quot;</span> <span class="p">:</span> <span class="n">names_dependent</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>               <span class="s2">&quot;scores&quot;</span><span class="p">:</span> <span class="n">scores</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>               <span class="s2">&quot;sample_index&quot;</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_pca</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>               <span class="s2">&quot;percent_explained&quot;</span><span class="p">:</span> <span class="n">percent_explained</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>               <span class="s2">&quot;corr_PC1_PC2&quot;</span><span class="p">:</span> <span class="n">coef</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>               <span class="p">}</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.reduction.ordination.rda" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rda</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">independent_variables</span><span class="p">,</span> <span class="n">dependent_variables</span><span class="p">,</span> <span class="n">n_comp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function that performs Redundancy Analysis.</p>
<p>Function makes use of skbio.stats.ordination.RDA on the input data and gives
the site scores and loadings.</p>
<h6 id="mibiscreen.analysis.reduction.ordination.rda--input">Input</h6>
<div class="highlight"><pre><span></span><code>data_frame : pd.dataframe
    Tabular data containing variables to be evaluated with standard
    column names and rows of sample data.
independent_variables : list of strings
    list with column names data to be the independent variables (=envirnoment)
dependent_variables : list of strings
    list with column names data to be the dependent variables (=species)
n_comp : int, default is 2
    number of dimensions to return
verbose : Boolean, The default is False.
    Set to True to get messages in the Console about the status of the run code.
</code></pre></div>
<h6 id="mibiscreen.analysis.reduction.ordination.rda--output">Output</h6>
<div class="highlight"><pre><span></span><code>results : Dictionary
    * method: name of ordination method (str)
    * loadings_independent: loadings of independent variables (np.ndarray)
    * loadings_dependent: loadings of dependent variables (np.ndarray)
    * names_independent: names of independent varialbes (list of str)
    * names_dependent: names of dependent varialbes (list of str)
    * scores: scores (np.ndarray)
    * sample_index: names of samples (list of str)
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/reduction/ordination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="k">def</span><span class="w"> </span><span class="nf">rda</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="n">n_comp</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="p">):</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function that performs Redundancy Analysis.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    Function makes use of skbio.stats.ordination.RDA on the input data and gives</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    the site scores and loadings.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    Input</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    -----</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        data_frame : pd.dataframe</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">            Tabular data containing variables to be evaluated with standard</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            column names and rows of sample data.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        independent_variables : list of strings</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            list with column names data to be the independent variables (=envirnoment)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        dependent_variables : list of strings</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">            list with column names data to be the dependent variables (=species)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        n_comp : int, default is 2</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">            number of dimensions to return</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        verbose : Boolean, The default is False.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">            Set to True to get messages in the Console about the status of the run code.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    Output</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">    ------</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        results : Dictionary</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">            * method: name of ordination method (str)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            * loadings_independent: loadings of independent variables (np.ndarray)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">            * loadings_dependent: loadings of dependent variables (np.ndarray)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">            * names_independent: names of independent varialbes (list of str)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">            * names_dependent: names of dependent varialbes (list of str)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">            * scores: scores (np.ndarray)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">            * sample_index: names of samples (list of str)</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;rda()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="n">results</span> <span class="o">=</span> <span class="n">constrained_ordination</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>                           <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>                           <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>                           <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;rda&#39;</span><span class="p">,</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>                           <span class="n">n_comp</span> <span class="o">=</span> <span class="n">n_comp</span><span class="p">,</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>                           <span class="p">)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mibiscreen.analysis.reduction.stable_isotope_regression" class="doc doc-heading">
            <code>stable_isotope_regression</code>


</h3>

    <div class="doc doc-contents ">

        <p>Routines for performing linear regression on isotope data.</p>
<p>@author: Alraune Zech</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.reduction.stable_isotope_regression.Keeling_regression" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Keeling_regression</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span> <span class="n">delta_mix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">relative_abundance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validate_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Performing a linear regression linked to the Keeling plot.</p>
<p>A Keeling fit/plot is an approach to identify the isotopic composition of a
contaminating source from measured concentrations and isotopic composition
(delta) of a target species in the mix of the source and a pool.</p>
<p>It is based on the linear relationship of the given quantities (concentration)
and delta-values (or alternatively the relative abundance x) which are measured
over time or across a spatial interval according to</p>
<div class="highlight"><pre><span></span><code>delta_mix = delta_source + m * 1/c_mix
</code></pre></div>
<p>where m is the slope relating the isotopic quantities of the pool (which mixes
with the sourse) by m = (delta_pool + delta_source)*c_pool.</p>
<p>The analysis is based on a linear regression of the inverse concentration
data against the delta (or x)-values. The parameter of interest, the delta
(or relative_abundance, respectively) of the source quantity is the
intercept of linear fit with the y-axis, or in other words, the absolute
value of the linear fit function.</p>
<p>A plot of the results with data and linear trendline can be generate with the
method Keeling_plot() [in the module visualize].</p>
<p>Note that the approach is only applicable if
    (i)  the isotopic composition of the unknown source is constant
    (ii) the concentration and isotopic composition of the target compound
        is constant (over time or across space)
        (i.e. in absence of contamination from the unknown source)</p>
<h6 id="mibiscreen.analysis.reduction.stable_isotope_regression.Keeling_regression--input">Input</h6>
<div class="highlight"><pre><span></span><code>concentration : np.array, pd.dataframe
    total molecular mass/molar concentration of target substance
    at different locations (at a time) or at different times (at one location)
delta_mix : np.array, pd.dataframe (same length as c_mix), default None
    relative isotope ratio (delta-value) of target substance
relative_abundance : None or np.array, pd.dataframe (same length as c_mix), default None
    if not None it replaces delta_mix in the inverse estimation and plotting
    relative abundance of target substance
validate_indices: boolean, default True
    flag to run index validation (i.e. removal of nan and infinity values)
verbose : Boolean, The default is False.
   Set to True to get messages in the Console about the status of the run code.
**kwargs : dict
    keywordarguments dictionary, e.g. for passing forward keywords to
    valid_indices()
</code></pre></div>
<h6 id="mibiscreen.analysis.reduction.stable_isotope_regression.Keeling_regression--returns">Returns</h6>
<div class="highlight"><pre><span></span><code>results : dict
    results of fitting, including:
        * coefficients : array/list of lenght 2, where coefficients[0]
            is the slope of the linear fit and coefficient[1] is the
            intercept of linear fit with y-axis, reflecting delta
            (or relative_abundance, respectively) of the source quantity
        * delta_C: np.array with isotope used for fitting - all samples
            where non-zero values are available for delta_C and delta_H
        * delta_H: np.array with isotope used for fitting - all samples
            where non-zero values are available for delta_C and delta_H
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/reduction/stable_isotope_regression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="k">def</span><span class="w"> </span><span class="nf">Keeling_regression</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                       <span class="n">delta_mix</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                       <span class="n">relative_abundance</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                       <span class="n">validate_indices</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                       <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                       <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                       <span class="p">):</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performing a linear regression linked to the Keeling plot.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    A Keeling fit/plot is an approach to identify the isotopic composition of a</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    contaminating source from measured concentrations and isotopic composition</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    (delta) of a target species in the mix of the source and a pool.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    It is based on the linear relationship of the given quantities (concentration)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    and delta-values (or alternatively the relative abundance x) which are measured</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    over time or across a spatial interval according to</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        delta_mix = delta_source + m * 1/c_mix</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">    where m is the slope relating the isotopic quantities of the pool (which mixes</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    with the sourse) by m = (delta_pool + delta_source)*c_pool.</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    The analysis is based on a linear regression of the inverse concentration</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    data against the delta (or x)-values. The parameter of interest, the delta</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    (or relative_abundance, respectively) of the source quantity is the</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    intercept of linear fit with the y-axis, or in other words, the absolute</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    value of the linear fit function.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    A plot of the results with data and linear trendline can be generate with the</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    method Keeling_plot() [in the module visualize].</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    Note that the approach is only applicable if</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        (i)  the isotopic composition of the unknown source is constant</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        (ii) the concentration and isotopic composition of the target compound</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">            is constant (over time or across space)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">            (i.e. in absence of contamination from the unknown source)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">    Input</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">    -----</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">        concentration : np.array, pd.dataframe</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">            total molecular mass/molar concentration of target substance</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">            at different locations (at a time) or at different times (at one location)</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        delta_mix : np.array, pd.dataframe (same length as c_mix), default None</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">            relative isotope ratio (delta-value) of target substance</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        relative_abundance : None or np.array, pd.dataframe (same length as c_mix), default None</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">            if not None it replaces delta_mix in the inverse estimation and plotting</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">            relative abundance of target substance</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        validate_indices: boolean, default True</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">            flag to run index validation (i.e. removal of nan and infinity values)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        verbose : Boolean, The default is False.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">           Set to True to get messages in the Console about the status of the run code.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        **kwargs : dict</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">            keywordarguments dictionary, e.g. for passing forward keywords to</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">            valid_indices()</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    -------</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        results : dict</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            results of fitting, including:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">                * coefficients : array/list of lenght 2, where coefficients[0]</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">                    is the slope of the linear fit and coefficient[1] is the</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">                    intercept of linear fit with y-axis, reflecting delta</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">                    (or relative_abundance, respectively) of the source quantity</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">                * delta_C: np.array with isotope used for fitting - all samples</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">                    where non-zero values are available for delta_C and delta_H</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">                * delta_H: np.array with isotope used for fitting - all samples</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">                    where non-zero values are available for delta_C and delta_H</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;Keeling_regression()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="k">if</span> <span class="n">delta_mix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">delta_mix</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;delta&#39;</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="k">elif</span> <span class="n">relative_abundance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">relative_abundance</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;relative abundance&#39;</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;One of the quantities &#39;delta_mix&#39; or &#39;relative_abundance&#39; must be provided&quot;</span><span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="c1">### check length of data arrays and remove non-valid values (NaN, inf &amp; zero)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="k">if</span> <span class="n">validate_indices</span><span class="p">:</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">valid_indices</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>                                 <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>                                 <span class="n">remove_nan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>                                 <span class="n">remove_infinity</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>                                 <span class="n">remove_zero</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>                                 <span class="p">)</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">concentration</span><span class="p">,</span><span class="n">y</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="c1">### perform linear regression</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">{}</span><span class="s2"> of the source quantity, being the intercept&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;of the linear fit, is identified with </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coefficients</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;______________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="n">results</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="n">concentration</span> <span class="o">=</span> <span class="n">data1</span><span class="p">,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="n">delta</span> <span class="o">=</span> <span class="n">data2</span><span class="p">,</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">coefficients</span><span class="p">,</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="p">)</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.reduction.stable_isotope_regression.Lambda_regression" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Lambda_regression</span><span class="p">(</span><span class="n">delta_C</span><span class="p">,</span> <span class="n">delta_H</span><span class="p">,</span> <span class="n">validate_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Performing linear regression to achieve Lambda value.</p>
<p>The Lambda values relates the 13C versus 2H signatures of a chemical
compound. Relative changes in the ratio can indicate the occurrence of
specific enzymatic degradation reactions.</p>
<p>The analysis is based on a linear regression of the hydrogen versus
carbon isotope signatures. The parameter of interest, the Lambda values
is the slope of the the linear trend line.</p>
<p>A plot of the results with data and linear trendline can be generate with the
method Lambda_plot() [in the module visualize].</p>
<h6 id="mibiscreen.analysis.reduction.stable_isotope_regression.Lambda_regression--input">Input</h6>
<div class="highlight"><pre><span></span><code>delta_C : np.array, pd.series
    relative isotope ratio (delta-value) of carbon of target molecule
delta_H : np.array, pd.series (same length as delta_C)
    relative isotope ratio (delta-value) of hydrogen of target molecule
validate_indices: boolean, default True
    flag to run index validation (i.e. removal of nan and infinity values)
verbose : Boolean, The default is False.
   Set to True to get messages in the Console about the status of the run code.
**kwargs : dict
    keywordarguments dictionary, e.g. for passing forward keywords to
    valid_indices()
</code></pre></div>
<h6 id="mibiscreen.analysis.reduction.stable_isotope_regression.Lambda_regression--returns">Returns</h6>
<div class="highlight"><pre><span></span><code>results : dict
    results of fitting, including:
        * coefficients : array/list of lenght 2, where coefficients[0]
            is the slope of the linear fit, reflecting the lambda values
            and coefficient[1] is the absolute value of the linear function
        * delta_C: np.array with isotope used for fitting - all samples
            where non-zero values are available for delta_C and delta_H
        * delta_H: np.array with isotope used for fitting - all samples
            where non-zero values are available for delta_C and delta_H
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/reduction/stable_isotope_regression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">Lambda_regression</span><span class="p">(</span><span class="n">delta_C</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>                      <span class="n">delta_H</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>                      <span class="n">validate_indices</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>                      <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>                      <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>                      <span class="p">):</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performing linear regression to achieve Lambda value.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    The Lambda values relates the 13C versus 2H signatures of a chemical</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    compound. Relative changes in the ratio can indicate the occurrence of</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    specific enzymatic degradation reactions.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    The analysis is based on a linear regression of the hydrogen versus</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    carbon isotope signatures. The parameter of interest, the Lambda values</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    is the slope of the the linear trend line.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    A plot of the results with data and linear trendline can be generate with the</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    method Lambda_plot() [in the module visualize].</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    Input</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    -----</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        delta_C : np.array, pd.series</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">            relative isotope ratio (delta-value) of carbon of target molecule</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        delta_H : np.array, pd.series (same length as delta_C)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">            relative isotope ratio (delta-value) of hydrogen of target molecule</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        validate_indices: boolean, default True</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            flag to run index validation (i.e. removal of nan and infinity values)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        verbose : Boolean, The default is False.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">           Set to True to get messages in the Console about the status of the run code.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        **kwargs : dict</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">            keywordarguments dictionary, e.g. for passing forward keywords to</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">            valid_indices()</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    -------</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        results : dict</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">            results of fitting, including:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">                * coefficients : array/list of lenght 2, where coefficients[0]</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">                    is the slope of the linear fit, reflecting the lambda values</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">                    and coefficient[1] is the absolute value of the linear function</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">                * delta_C: np.array with isotope used for fitting - all samples</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">                    where non-zero values are available for delta_C and delta_H</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">                * delta_H: np.array with isotope used for fitting - all samples</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">                    where non-zero values are available for delta_C and delta_H</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="c1">### check length of data arrays and remove non-valid values (NaN, inf &amp; zero)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;Lambda_regression()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">if</span> <span class="n">validate_indices</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">valid_indices</span><span class="p">(</span><span class="n">delta_C</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>                                     <span class="n">delta_H</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>                                     <span class="n">remove_nan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>                                     <span class="n">remove_infinity</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>                                     <span class="n">remove_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>                                     <span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">delta_C</span><span class="p">,</span><span class="n">delta_H</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="c1">### perform linear regression</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lambda value, being the slope of the linear fit is </span><span class="se">\n</span><span class="s2"> identified with </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coefficients</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;______________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">results</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">delta_C</span> <span class="o">=</span> <span class="n">data1</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="n">delta_H</span> <span class="o">=</span> <span class="n">data2</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">coefficients</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Rayleigh_fractionation</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">validate_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Performing Rayleigh fractionation analysis.</p>
<p>Rayleigh fractionation is a common application to characterize the removal
of a substance from a finite pool using stable isotopes. It is based on the
change in the isotopic composition of the pool due to different kinetics of
the change in lighter and heavier isotopes.</p>
<p>We follow the most simple approach assuming that the substance removal follows
first-order kinetics, where the rate coefficients for the lighter and heavier
isotopes of the substance differ due to kinetic isotope fractionation effects.
The isotopic composition of the remaining substance in the pool will change
over time, leading to the so-called Rayleigh fractionation.</p>
<p>The analysis is based on a linear regression of the log-transformed concentration
data against the delta-values. The parameter of interest, the kinetic
fractionation factor (epsilon or alpha -1) of the removal process is the slope
of the the linear trend line.</p>
<p>A plot of the results with data and linear trendline can be generate with the
method Rayleigh_fractionation_plot() [in the module visualize].</p>
<h6 id="mibiscreen.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation--input">Input</h6>
<div class="highlight"><pre><span></span><code>concentration : np.array, pd.dataframe
    total molecular mass/molar concentration of target substance
    at different locations (at a time) or at different times (at one location)
delta : np.array, pd.dataframe (same length as concentration)
    relative isotope ratio (delta-value) of target substance
validate_indices: boolean, default True
    flag to run index validation (i.e. removal of nan and infinity values)
verbose : Boolean, The default is False.
   Set to True to get messages in the Console about the status of the run code.
**kwargs : dict
    keywordarguments dictionary, e.g. for passing forward keywords to
    valid_indices()
</code></pre></div>
<h6 id="mibiscreen.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation--returns">Returns</h6>
<div class="highlight"><pre><span></span><code>results : dict
    results of fitting, including:
        * coefficients : array/list of lenght 2, where coefficients[0]
            is the slope of the linear fit, reflecting the kinetic
            fractionation factor (epsilon or alpha -1) of the removal process
            and coefficient[1] is the absolute value of the linear function
        * delta_C: np.array with isotope used for fitting - all samples
            where non-zero values are available for delta_C and delta_H
        * delta_H: np.array with isotope used for fitting - all samples
            where non-zero values are available for delta_C and delta_H
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/reduction/stable_isotope_regression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="k">def</span><span class="w"> </span><span class="nf">Rayleigh_fractionation</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>                           <span class="n">delta</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>                           <span class="n">validate_indices</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                           <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>                           <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                           <span class="p">):</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performing Rayleigh fractionation analysis.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    Rayleigh fractionation is a common application to characterize the removal</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    of a substance from a finite pool using stable isotopes. It is based on the</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">    change in the isotopic composition of the pool due to different kinetics of</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    the change in lighter and heavier isotopes.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    We follow the most simple approach assuming that the substance removal follows</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    first-order kinetics, where the rate coefficients for the lighter and heavier</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">    isotopes of the substance differ due to kinetic isotope fractionation effects.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    The isotopic composition of the remaining substance in the pool will change</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    over time, leading to the so-called Rayleigh fractionation.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    The analysis is based on a linear regression of the log-transformed concentration</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    data against the delta-values. The parameter of interest, the kinetic</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    fractionation factor (epsilon or alpha -1) of the removal process is the slope</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    of the the linear trend line.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    A plot of the results with data and linear trendline can be generate with the</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    method Rayleigh_fractionation_plot() [in the module visualize].</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    Input</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    -----</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        concentration : np.array, pd.dataframe</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            total molecular mass/molar concentration of target substance</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">            at different locations (at a time) or at different times (at one location)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        delta : np.array, pd.dataframe (same length as concentration)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            relative isotope ratio (delta-value) of target substance</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        validate_indices: boolean, default True</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            flag to run index validation (i.e. removal of nan and infinity values)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        verbose : Boolean, The default is False.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">           Set to True to get messages in the Console about the status of the run code.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        **kwargs : dict</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            keywordarguments dictionary, e.g. for passing forward keywords to</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            valid_indices()</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    -------</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        results : dict</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            results of fitting, including:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">                * coefficients : array/list of lenght 2, where coefficients[0]</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">                    is the slope of the linear fit, reflecting the kinetic</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">                    fractionation factor (epsilon or alpha -1) of the removal process</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">                    and coefficient[1] is the absolute value of the linear function</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">                * delta_C: np.array with isotope used for fitting - all samples</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">                    where non-zero values are available for delta_C and delta_H</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">                * delta_H: np.array with isotope used for fitting - all samples</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">                    where non-zero values are available for delta_C and delta_H</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="c1">### check length of data arrays and remove non-valid values (NaN, inf &amp; zero)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;Rayleigh_fractionation()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="k">if</span> <span class="n">validate_indices</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">valid_indices</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                                 <span class="n">delta</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                                 <span class="n">remove_nan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                                 <span class="n">remove_infinity</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                                 <span class="n">remove_zero</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                                 <span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">concentration</span><span class="p">,</span><span class="n">delta</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="c1">### perform linear regression</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">data1</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Concentration data provided is negative, but has to be positive.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data1</span><span class="p">),</span> <span class="n">data2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The kinetic fractionation factor (&#39;epsilon&#39; or &#39;alpha-1&#39;) of&quot;</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the removal process, being the slope of the linear fit, is &quot;</span><span class="p">)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;identified with </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coefficients</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;______________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">results</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">concentration</span> <span class="o">=</span> <span class="n">data1</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">delta</span> <span class="o">=</span> <span class="n">data2</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">coefficients</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.reduction.stable_isotope_regression.extract_isotope_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_isotope_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">molecule</span><span class="p">,</span> <span class="n">name_13C</span><span class="o">=</span><span class="s1">&#39;delta_13C&#39;</span><span class="p">,</span> <span class="n">name_2H</span><span class="o">=</span><span class="s1">&#39;delta_2H&#39;</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Extracts isotope data from standardised input-dataframe.</p>
<h6 id="mibiscreen.analysis.reduction.stable_isotope_regression.extract_isotope_data--parameters">Parameters</h6>
<p>df : pd.dataframe
    numeric (observational) data
molecule : str
    name of contaminant molecule to extract isotope data for
name_13C : str, default &lsquo;delta_13C&rsquo; (standard name)
    name of C13 isotope to extract data for
name_2H : str, default &lsquo;delta_2H&rsquo; (standard name)
    name of deuterium isotope to extract data for</p>
<h6 id="mibiscreen.analysis.reduction.stable_isotope_regression.extract_isotope_data--returns">Returns</h6>
<p>C_data : np.array
    numeric isotope data
H_data : np.array
    numeric isotope data</p>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/reduction/stable_isotope_regression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_isotope_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                         <span class="n">molecule</span><span class="p">,</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>                         <span class="n">name_13C</span> <span class="o">=</span> <span class="s1">&#39;delta_13C&#39;</span><span class="p">,</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                         <span class="n">name_2H</span> <span class="o">=</span> <span class="s1">&#39;delta_2H&#39;</span><span class="p">,</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                         <span class="p">):</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts isotope data from standardised input-dataframe.</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">    df : pd.dataframe</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        numeric (observational) data</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">    molecule : str</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        name of contaminant molecule to extract isotope data for</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">    name_13C : str, default &#39;delta_13C&#39; (standard name)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        name of C13 isotope to extract data for</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    name_2H : str, default &#39;delta_2H&#39; (standard name)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        name of deuterium isotope to extract data for</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">    -------</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">    C_data : np.array</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        numeric isotope data</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    H_data : np.array</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        numeric isotope data</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="n">molecule_standard</span> <span class="o">=</span> <span class="n">names_contaminants</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>    <span class="n">isotope_13C</span> <span class="o">=</span> <span class="n">names_isotopes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name_13C</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>    <span class="n">isotope_2H</span> <span class="o">=</span> <span class="n">names_isotopes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name_2H</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="k">if</span> <span class="n">molecule_standard</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Contaminant (name) unknown: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">molecule</span><span class="p">))</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="k">if</span> <span class="n">isotope_13C</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Isotope (name) unknown: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_13C</span><span class="p">))</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="k">if</span> <span class="n">isotope_2H</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Isotope (name) unknown: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_2H</span><span class="p">))</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="n">name_C</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">isotope_13C</span><span class="p">,</span><span class="n">molecule_standard</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="n">name_H</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">isotope_2H</span><span class="p">,</span><span class="n">molecule_standard</span><span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="k">if</span> <span class="n">name_C</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No isotope data available for : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_C</span><span class="p">))</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="k">if</span> <span class="n">name_H</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No isotope data available for : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_H</span><span class="p">))</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="n">C_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">name_C</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="n">H_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">name_H</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="k">return</span> <span class="n">C_data</span><span class="p">,</span> <span class="n">H_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.reduction.stable_isotope_regression.valid_indices" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">valid_indices</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">remove_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_infinity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Identifies valid indices in two equaly long arrays and compresses both.</p>
<p>Optional numerical to remove from array are: nan, infinity and zero values.</p>
<h6 id="mibiscreen.analysis.reduction.stable_isotope_regression.valid_indices--parameters">Parameters</h6>
<p>data1 : np.array or pd.series
    numeric data
data2 : np.array or pd.series (same len/shape as data1)
    numeric data
remove_nan : boolean, default True
    flag to remove nan-values
remove_infinity : boolean, default True
    flag to remove infinity values
remove_zero : boolean, default False
    flag to remove zero values
**kwargs : dict
    keywordarguments dictionary</p>
<h6 id="mibiscreen.analysis.reduction.stable_isotope_regression.valid_indices--returns">Returns</h6>
<p>data1 : np.array or pd.series
    numeric data of reduced length where only data at valid indices is in
data2 : np.array or pd.series
    numeric data of reduced length where only data at valid indices is in</p>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/reduction/stable_isotope_regression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="k">def</span><span class="w"> </span><span class="nf">valid_indices</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>                  <span class="n">data2</span><span class="p">,</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>                  <span class="n">remove_nan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>                  <span class="n">remove_infinity</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>                  <span class="n">remove_zero</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>                  <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>                  <span class="p">):</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Identifies valid indices in two equaly long arrays and compresses both.</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    Optional numerical to remove from array are: nan, infinity and zero values.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    data1 : np.array or pd.series</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        numeric data</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">    data2 : np.array or pd.series (same len/shape as data1)</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        numeric data</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">    remove_nan : boolean, default True</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        flag to remove nan-values</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    remove_infinity : boolean, default True</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        flag to remove infinity values</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">    remove_zero : boolean, default False</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        flag to remove zero values</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">    **kwargs : dict</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        keywordarguments dictionary</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    -------</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">    data1 : np.array or pd.series</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        numeric data of reduced length where only data at valid indices is in</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">    data2 : np.array or pd.series</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        numeric data of reduced length where only data at valid indices is in</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="k">if</span> <span class="n">data1</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">data2</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Shape of provided data must be identical.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="n">valid_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="k">if</span> <span class="n">remove_nan</span><span class="p">:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="n">valid_indices</span> <span class="o">*=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="k">if</span> <span class="n">remove_infinity</span><span class="p">:</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="n">valid_indices</span> <span class="o">*=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="k">if</span> <span class="n">remove_zero</span><span class="p">:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="n">valid_indices</span> <span class="o">*=</span> <span class="p">(</span><span class="n">data1</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="k">return</span> <span class="n">data1</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">],</span><span class="n">data2</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mibiscreen.analysis.reduction.transformation" class="doc doc-heading">
            <code>transformation</code>


</h3>

    <div class="doc doc-contents ">

        <p>Routines for performing ordination statistics on sample data.</p>
<p>@author: Alraune Zech, Jorrit Bakker</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.reduction.transformation.filter_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_values</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">replace_NaN</span><span class="o">=</span><span class="s1">&#39;remove&#39;</span><span class="p">,</span> <span class="n">drop_rows</span><span class="o">=</span><span class="p">[],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Filtering values of dataframes for ordination to assure all are numeric.</p>
<p>Ordination methods require all cells to be filled. This method checks the
provided data frame if values are missing/NaN or not numeric and handles
missing/NaN values accordingly.</p>
<p>It then removes select rows and mutates the cells containing NULL values based
on the input parameters.</p>
<h6 id="mibiscreen.analysis.reduction.transformation.filter_values--input">Input</h6>
<div class="highlight"><pre><span></span><code>data_frame : pd.dataframe
    Tabular data containing variables to be evaluated with standard
    column names and rows of sample data.
replace_NaN : string or float, default &quot;remove&quot;
    Keyword specifying how to handle missing/NaN/non-numeric values, options:
        - remove: remove rows with missing values
        - zero: replace values with 0.0
        - average: replace the missing values with the average of the variable
                    (using all other available samples)
        - median: replace the missing values with the median of the variable
                                (using all other available samples)
        - float-value: replace all empty cells with that numeric value
drop_rows : List, default [] (empty list)
    List of rows that should be removed from dataframe.
inplace: bool, default True
    If False, return a copy. Otherwise, do operation in place.
verbose : Boolean, The default is False.
   Set to True to get messages in the Console about the status of the run code.
</code></pre></div>
<h6 id="mibiscreen.analysis.reduction.transformation.filter_values--output">Output</h6>
<div class="highlight"><pre><span></span><code>data_filtered : pd.dataframe
    Tabular data containing filtered data.
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/reduction/transformation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">filter_values</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>                  <span class="n">replace_NaN</span> <span class="o">=</span> <span class="s1">&#39;remove&#39;</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>                  <span class="n">drop_rows</span> <span class="o">=</span> <span class="p">[],</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>                  <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>                  <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filtering values of dataframes for ordination to assure all are numeric.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Ordination methods require all cells to be filled. This method checks the</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    provided data frame if values are missing/NaN or not numeric and handles</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    missing/NaN values accordingly.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    It then removes select rows and mutates the cells containing NULL values based</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    on the input parameters.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Input</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    -----</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        data_frame : pd.dataframe</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">            Tabular data containing variables to be evaluated with standard</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">            column names and rows of sample data.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        replace_NaN : string or float, default &quot;remove&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">            Keyword specifying how to handle missing/NaN/non-numeric values, options:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">                - remove: remove rows with missing values</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">                - zero: replace values with 0.0</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">                - average: replace the missing values with the average of the variable</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">                            (using all other available samples)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">                - median: replace the missing values with the median of the variable</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">                                        (using all other available samples)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">                - float-value: replace all empty cells with that numeric value</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        drop_rows : List, default [] (empty list)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">            List of rows that should be removed from dataframe.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        inplace: bool, default True</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">            If False, return a copy. Otherwise, do operation in place.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        verbose : Boolean, The default is False.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">           Set to True to get messages in the Console about the status of the run code.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    Output</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    ------</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        data_filtered : pd.dataframe</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">            Tabular data containing filtered data.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="n">inplace</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;==============================================================================&quot;</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Perform filtering of values since ordination requires all values to be numeric.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drop_rows</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">drop_rows</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The samples of rows </span><span class="si">{}</span><span class="s1"> have been removed&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">drop_rows</span><span class="p">))</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="c1"># Identifying which rows and columns contain any amount of NULL cells and putting them in a list.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">NaN_rows</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">NaN_cols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="c1"># If there are any rows containing NULL cells, the NULL values will be filtered</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">NaN_rows</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="k">if</span> <span class="n">replace_NaN</span> <span class="o">==</span> <span class="s1">&#39;remove&#39;</span><span class="p">:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>            <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">NaN_rows</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;The sample row(s) have been removed since they contain NaN values: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">NaN_rows</span><span class="p">)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="k">elif</span> <span class="n">replace_NaN</span> <span class="o">==</span> <span class="s1">&#39;zero&#39;</span><span class="p">:</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="n">set_NaN</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">set_NaN</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;The values of the empty cells have been set to zero (0.0)&#39;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">replace_NaN</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>            <span class="n">set_NaN</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">replace_NaN</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>            <span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">set_NaN</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;The values of the empty cells have been set to the value of </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">set_NaN</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="k">elif</span> <span class="n">replace_NaN</span> <span class="o">==</span> <span class="s2">&quot;average&quot;</span><span class="p">:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">NaN_cols</span><span class="p">:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>                <span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;The values of the empty cells have been replaced by the average of</span><span class="se">\</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="s1">                  the corresponding variables (using all other available samples).&#39;</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="k">elif</span> <span class="n">replace_NaN</span> <span class="o">==</span> <span class="s2">&quot;median&quot;</span><span class="p">:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">NaN_cols</span><span class="p">:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                <span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;The values of the empty cells have been replaced by the median of</span><span class="se">\</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="s1">                  the corresponding variables (using all other available samples).&#39;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value of &#39;replace_NaN&#39; unknown: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">replace_NaN</span><span class="p">))</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;No data to be filtered out.&#39;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.reduction.transformation.transform_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">transform_values</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">name_list</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;log_scale&#39;</span><span class="p">,</span> <span class="n">log_scale_A</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">log_scale_B</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Extracting data from dataframe for specified variables.</p>
        <hr />
<div class="highlight"><pre><span></span><code>data_frame: pandas.DataFrames
    dataframe with the measurements
name_list: string or list of strings, default &#39;all&#39;
    list of quantities (column names) to perfrom transformation on
how: string, default &#39;standardize&#39;
    Type of transformation:
        * standardize
        * log_scale
        * center
log_scale_A : Integer or float, default 1
    Log transformation parameter A: log10(Ax+B).
log_scale_B : Integer or float, default 1
    Log transformation parameter B: log10(Ax+B).
inplace: bool, default True
    If False, return a copy. Otherwise, do operation in place and return None.
verbose : Boolean, The default is False.
   Set to True to get messages in the Console about the status of the run code.
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    dataframe with the measurements
</code></pre></div>
<h6 id="mibiscreen.analysis.reduction.transformation.transform_values--raises">Raises:</h6>
<p>None (yet).</p>
<h6 id="mibiscreen.analysis.reduction.transformation.transform_values--example">Example:</h6>
<p>To be added.</p>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/reduction/transformation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="k">def</span><span class="w"> </span><span class="nf">transform_values</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                     <span class="n">name_list</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                     <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;log_scale&#39;</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                     <span class="n">log_scale_A</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>                     <span class="n">log_scale_B</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                     <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                     <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                     <span class="p">):</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracting data from dataframe for specified variables.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    -------</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        data_frame: pandas.DataFrames</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">            dataframe with the measurements</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        name_list: string or list of strings, default &#39;all&#39;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">            list of quantities (column names) to perfrom transformation on</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        how: string, default &#39;standardize&#39;</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">            Type of transformation:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">                * standardize</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">                * log_scale</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">                * center</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        log_scale_A : Integer or float, default 1</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">            Log transformation parameter A: log10(Ax+B).</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        log_scale_B : Integer or float, default 1</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">            Log transformation parameter B: log10(Ax+B).</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        inplace: bool, default True</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            If False, return a copy. Otherwise, do operation in place and return None.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        verbose : Boolean, The default is False.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">           Set to True to get messages in the Console about the status of the run code.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    -------</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            dataframe with the measurements</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    -------</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    None (yet).</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    -------</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    To be added.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;transform_values()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="n">inplace</span><span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="n">quantities</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">determine_quantities</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>                                      <span class="n">name_list</span> <span class="o">=</span> <span class="n">name_list</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>                                      <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="k">for</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="n">quantities</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="s1">&#39;log_scale&#39;</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="n">data</span><span class="p">[</span><span class="n">quantity</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">log_scale_A</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="n">quantity</span><span class="p">]</span> <span class="o">+</span> <span class="n">log_scale_B</span><span class="p">)</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="k">elif</span> <span class="n">how</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="n">data</span><span class="p">[</span><span class="n">quantity</span><span class="p">]</span> <span class="o">=</span>  <span class="n">data</span><span class="p">[</span><span class="n">quantity</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">quantity</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="k">elif</span> <span class="n">how</span> <span class="o">==</span> <span class="s1">&#39;standardize&#39;</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="n">data</span><span class="p">[</span><span class="n">quantity</span><span class="p">]</span> <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">quantity</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value of &#39;how&#39; unknown: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">how</span><span class="p">))</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="mibiscreen.analysis.sample" class="doc doc-heading">
            <code>sample</code>


</h2>

    <div class="doc doc-contents ">

        <p>mibiscreen module for data analysis performed on each sample.</p>








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="mibiscreen.analysis.sample.concentrations" class="doc doc-heading">
            <code>concentrations</code>


</h3>

    <div class="doc doc-contents ">

        <p>Routines for calculating total concentrations and counts for samples.</p>
<p>@author: Alraune Zech</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.sample.concentrations.thresholds_for_intervention" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">thresholds_for_intervention</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">contaminant_group</span><span class="o">=</span><span class="s1">&#39;BTEXIIN&#39;</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function to evalute intervention threshold exceedance.</p>
<div class="highlight"><pre><span></span><code>Determines which contaminants exceed concentration thresholds set by
the Dutch government for intervention.
</code></pre></div>
<h6 id="mibiscreen.analysis.sample.concentrations.thresholds_for_intervention--input">Input</h6>
<div class="highlight"><pre><span></span><code>data_frame: pd.DataFrame
    Contaminant contentrations in [ug/l], i.e. microgram per liter
contaminant_group: str
    Short name for group of contaminants to use
    default is &#39;BTEXIIN&#39; (for benzene, toluene, ethylbenzene, xylene,
                          indene, indane and naphthaline)
include: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean, default False
    verbose flag
</code></pre></div>
<h6 id="mibiscreen.analysis.sample.concentrations.thresholds_for_intervention--output">Output</h6>
<div class="highlight"><pre><span></span><code>intervention: pd.DataFrame
    DataFrame of similar format as input data with well specification and
    three columns on intervention threshold exceedance analysis:
        - traffic light if well requires intervention
        - number of contaminants exceeding the intervention value
        - list of contaminants above the threshold of intervention
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/sample/concentrations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="k">def</span><span class="w"> </span><span class="nf">thresholds_for_intervention</span><span class="p">(</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="n">contaminant_group</span> <span class="o">=</span> <span class="s2">&quot;BTEXIIN&quot;</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="n">include</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="p">):</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to evalute intervention threshold exceedance.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        Determines which contaminants exceed concentration thresholds set by</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        the Dutch government for intervention.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    Input</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    -----</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        data_frame: pd.DataFrame</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">            Contaminant contentrations in [ug/l], i.e. microgram per liter</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        contaminant_group: str</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            Short name for group of contaminants to use</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">            default is &#39;BTEXIIN&#39; (for benzene, toluene, ethylbenzene, xylene,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">                                  indene, indane and naphthaline)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        include: bool, default False</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        verbose: Boolean, default False</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">            verbose flag</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">    Output</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">    ------</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        intervention: pd.DataFrame</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">            DataFrame of similar format as input data with well specification and</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">            three columns on intervention threshold exceedance analysis:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">                - traffic light if well requires intervention</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">                - number of contaminants exceeding the intervention value</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">                - list of contaminants above the threshold of intervention</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;thresholds_for_intervention()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="c1">### check on correct data input format and extracting column names as list</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="n">include</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="c1">### sorting out which columns in data to evaluate</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="n">quantities</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">determine_quantities</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>                                      <span class="n">name_list</span> <span class="o">=</span> <span class="n">contaminant_group</span><span class="p">,</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>                                      <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="k">if</span> <span class="n">include</span><span class="p">:</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="n">intervention</span> <span class="o">=</span> <span class="n">data</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="n">intervention</span><span class="o">=</span> <span class="n">extract_settings</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="n">nr_samples</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># number of samples</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="n">traffic_nr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nr_samples</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="n">traffic_list</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr_samples</span><span class="p">)]</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">quantities</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="n">th_value</span> <span class="o">=</span> <span class="n">properties</span><span class="p">[</span><span class="n">cont</span><span class="p">][</span><span class="s1">&#39;thresholds_for_intervention_NL&#39;</span><span class="p">]</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>            <span class="n">traffic_nr</span> <span class="o">+=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">th_value</span><span class="p">)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr_samples</span><span class="p">):</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>                <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">th_value</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>                    <span class="n">traffic_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data not in standardized format. Run &#39;standardize()&#39; first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="n">traffic_light</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">traffic_nr</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="n">traffic_light</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">traffic_nr</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="n">intervention</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_intervention_traffic</span><span class="p">]</span> <span class="o">=</span> <span class="n">traffic_light</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="n">intervention</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_intervention_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">traffic_nr</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="n">intervention</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_intervention_contaminants</span><span class="p">]</span> <span class="o">=</span> <span class="n">traffic_list</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Evaluation of contaminant concentrations exceeding intervention values for </span><span class="si">{}</span><span class="s2">:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="n">contaminant_group</span><span class="p">))</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Red light: Intervention values exceeded for </span><span class="si">{}</span><span class="s2"> out of </span><span class="si">{}</span><span class="s2"> locations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">traffic_nr</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">),</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;green light: Concentrations below intervention values at </span><span class="si">{}</span><span class="s2"> out of </span><span class="si">{}</span><span class="s2"> locations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">traffic_nr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">),</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yellow light: No decision possible at </span><span class="si">{}</span><span class="s2"> out of </span><span class="si">{}</span><span class="s2"> locations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">traffic_nr</span><span class="p">)),</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="k">return</span> <span class="n">intervention</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.sample.concentrations.total_concentration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_concentration</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">name_list</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">name_column</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate total concentration of given list of quantities.</p>
<h6 id="mibiscreen.analysis.sample.concentrations.total_concentration--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    Contaminant concentrations in [ug/l], i.e. microgram per liter
name_list: str or list, dafault is &#39;all&#39;
    either short name for group of quantities to use, such as:
            - &#39;all&#39; (all qunatities given in data frame except settings)
            - &#39;BTEX&#39; (for contaminant group: benzene, toluene, ethylbenzene, xylene)
            - &#39;BTEXIIN&#39; (for contaminant group: benzene, toluene, ethylbenzene, xylene,
                          indene, indane and naphthaline)
    or list of strings with names of quantities to use
name_column: str or False, default is &#39;False&#39;
    optional name of column
verbose: Boolean
    verbose flag (default False)
include: bool, default False
    whether to include calculated values to DataFrame
</code></pre></div>
<h6 id="mibiscreen.analysis.sample.concentrations.total_concentration--output">Output</h6>
<div class="highlight"><pre><span></span><code>tot_conc: pd.Series
    Total concentration of contaminants in [ug/l]
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/sample/concentrations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">total_concentration</span><span class="p">(</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>        <span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="n">name_list</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="n">name_column</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>        <span class="n">include</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="p">):</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate total concentration of given list of quantities.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Input</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    -----</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">            Contaminant concentrations in [ug/l], i.e. microgram per liter</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        name_list: str or list, dafault is &#39;all&#39;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">            either short name for group of quantities to use, such as:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">                    - &#39;all&#39; (all qunatities given in data frame except settings)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">                    - &#39;BTEX&#39; (for contaminant group: benzene, toluene, ethylbenzene, xylene)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">                    - &#39;BTEXIIN&#39; (for contaminant group: benzene, toluene, ethylbenzene, xylene,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">                                  indene, indane and naphthaline)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">            or list of strings with names of quantities to use</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        name_column: str or False, default is &#39;False&#39;</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            optional name of column</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">            verbose flag (default False)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        include: bool, default False</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">            whether to include calculated values to DataFrame</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    Output</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    ------</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        tot_conc: pd.Series</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">            Total concentration of contaminants in [ug/l]</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;total_concentration()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="c1">### check on correct data input format and extracting column names as list</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="n">include</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="c1">### sorting out which columns in data to use for summation of concentrations</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">quantities</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">determine_quantities</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span><span class="n">name_list</span> <span class="o">=</span> <span class="n">name_list</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="c1">### actually performing summation</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="c1"># try:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">tot_conc</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">quantities</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="c1"># except TypeError:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="c1">#     raise ValueError(&quot;Data not in standardized format. Run &#39;standardize()&#39; first.&quot;)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="k">if</span> <span class="n">name_column</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>            <span class="n">name_column</span> <span class="o">=</span> <span class="s1">&#39;total concentration </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>            <span class="n">name_column</span> <span class="o">=</span> <span class="s1">&#39;total concentration selection&#39;</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name_column</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Keyword &#39;name_column&#39; needs to be a string or False.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">tot_conc</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">name_column</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> in [ug/l] is:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_column</span><span class="p">,</span><span class="n">tot_conc</span><span class="p">))</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="c1">### additing series to data frame</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">if</span> <span class="n">include</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">data</span><span class="p">[</span><span class="n">name_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">tot_conc</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="k">return</span> <span class="n">tot_conc</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.sample.concentrations.total_contaminant_concentration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_contaminant_concentration</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">contaminant_group</span><span class="o">=</span><span class="s1">&#39;BTEXIIN&#39;</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function to calculate total concentration of contaminants.</p>
<h6 id="mibiscreen.analysis.sample.concentrations.total_contaminant_concentration--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    Contaminant contentrations in [ug/l], i.e. microgram per liter
contaminant_group: str
    Short name for group of contaminants to use
    default is &#39;BTEXIIN&#39; (for benzene, toluene, ethylbenzene, xylene,
                          indene, indane and naphthaline)
include: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean
    verbose flag (default False)
</code></pre></div>
<h6 id="mibiscreen.analysis.sample.concentrations.total_contaminant_concentration--output">Output</h6>
<div class="highlight"><pre><span></span><code>tot_conc: pd.Series
    Total concentration of contaminants in [ug/l]
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/sample/concentrations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="k">def</span><span class="w"> </span><span class="nf">total_contaminant_concentration</span><span class="p">(</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="n">contaminant_group</span> <span class="o">=</span> <span class="s2">&quot;BTEXIIN&quot;</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="n">include</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="p">):</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to calculate total concentration of contaminants.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    Input</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">    -----</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">            Contaminant contentrations in [ug/l], i.e. microgram per liter</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        contaminant_group: str</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            Short name for group of contaminants to use</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            default is &#39;BTEXIIN&#39; (for benzene, toluene, ethylbenzene, xylene,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">                                  indene, indane and naphthaline)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        include: bool, default False</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">            verbose flag (default False)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    Output</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    ------</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        tot_conc: pd.Series</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">            Total concentration of contaminants in [ug/l]</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;total_contaminant_concentration()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">tot_conc</span> <span class="o">=</span> <span class="n">total_concentration</span><span class="p">(</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">name_list</span> <span class="o">=</span> <span class="n">contaminant_group</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">name_column</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">name_total_contaminants</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">include</span> <span class="o">=</span> <span class="n">include</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="p">)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="k">return</span> <span class="n">tot_conc</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.sample.concentrations.total_count" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_count</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">name_list</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate total number of quantities with concentration exceeding threshold value.</p>
<h6 id="mibiscreen.analysis.sample.concentrations.total_count--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    Contaminant concentrations in [ug/l], i.e. microgram per liter
name_ist: str or list, dafault is &#39;all&#39;
    either short name for group of quantities to use, such as:
            - &#39;all&#39; (all qunatities given in data frame except settings)
            - &#39;BTEX&#39; (for benzene, toluene, ethylbenzene, xylene)
            - &#39;BTEXIIN&#39; (for benzene, toluene, ethylbenzene, xylene,
                          indene, indane and naphthaline)
    or list of strings with names of quantities to use
threshold: float, default 0
    threshold concentration value in [ug/l] to test on exceedence
verbose: Boolean
    verbose flag (default False)
include: bool, default False
    whether to include calculated values to DataFrame
</code></pre></div>
<h6 id="mibiscreen.analysis.sample.concentrations.total_count--output">Output</h6>
<div class="highlight"><pre><span></span><code>tot_count: pd.Series
    Total number of quantities with concentration exceeding threshold value
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/sample/concentrations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="k">def</span><span class="w"> </span><span class="nf">total_count</span><span class="p">(</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">name_list</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">include</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="p">):</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate total number of quantities with concentration exceeding threshold value.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    Input</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    -----</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            Contaminant concentrations in [ug/l], i.e. microgram per liter</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        name_ist: str or list, dafault is &#39;all&#39;</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            either short name for group of quantities to use, such as:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">                    - &#39;all&#39; (all qunatities given in data frame except settings)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">                    - &#39;BTEX&#39; (for benzene, toluene, ethylbenzene, xylene)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">                    - &#39;BTEXIIN&#39; (for benzene, toluene, ethylbenzene, xylene,</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">                                  indene, indane and naphthaline)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">            or list of strings with names of quantities to use</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        threshold: float, default 0</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            threshold concentration value in [ug/l] to test on exceedence</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            verbose flag (default False)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        include: bool, default False</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            whether to include calculated values to DataFrame</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    Output</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    ------</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        tot_count: pd.Series</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            Total number of quantities with concentration exceeding threshold value</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;total_count()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">threshold</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="k">if</span> <span class="n">threshold</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Threshold value &#39;</span><span class="si">{}</span><span class="s2">&#39; not valid.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">threshold</span><span class="p">))</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="c1">### check on correct data input format and extracting column names as list</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="n">include</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="c1">### sorting out which column in data to use for summation of concentrations</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">quantities</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">determine_quantities</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span><span class="n">name_list</span> <span class="o">=</span> <span class="n">name_list</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="c1">### actually performing count of values above threshold:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="n">total_count</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">quantities</span><span class="p">]</span><span class="o">&gt;</span><span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data not in standardized format. Run &#39;standardize()&#39; first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="n">name_column</span> <span class="o">=</span> <span class="s1">&#39;total count </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="n">name_column</span> <span class="o">=</span> <span class="s1">&#39;total count selection&#39;</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="n">total_count</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">name_column</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of quantities out of </span><span class="si">{}</span><span class="s2"> exceeding </span><span class="se">\</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="s2">              concentration of </span><span class="si">{:.2f}</span><span class="s2"> ug/l :</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">quantities</span><span class="p">),</span><span class="n">threshold</span><span class="p">,</span><span class="n">total_count</span><span class="p">))</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="k">if</span> <span class="n">include</span><span class="p">:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">data</span><span class="p">[</span><span class="n">name_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_count</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="k">return</span> <span class="n">total_count</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mibiscreen.analysis.sample.properties" class="doc doc-heading">
            <code>properties</code>


</h3>

    <div class="doc doc-contents ">

        <p>Properties for Natural Attenuation Screening.</p>
<p>File containing name specifications of quantities and parameters measured in
groundwater samples useful for biodegredation and bioremediation analysis</p>
<p>@author: A. Zech</p>








  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mibiscreen.analysis.sample.screening_NA" class="doc doc-heading">
            <code>screening_NA</code>


</h3>

    <div class="doc doc-contents ">

        <p>Routines for calculating natural attenuation potential.</p>
<p>@author: Alraune Zech</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.sample.screening_NA.electron_balance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">electron_balance</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculating electron balance between reductors and oxidators.</p>
<p>Determines ratio between the amount of electrons available and those
needed for oxidation of the contaminants based on values determined by
the routines &ldquo;reductors()&rdquo; and &ldquo;oxidators()&rdquo;.</p>
<p>Ratio higher then one indicates sufficient electrons available for degredation,
values smaller 1 indicates not sufficient supply of electrons to reduce
the present amount of contaminants.</p>
<h6 id="mibiscreen.analysis.sample.screening_NA.electron_balance--input">Input</h6>
<div class="highlight"><pre><span></span><code>data_frame: pd.DataFrame
    tabular data containinng &quot;total_reductors&quot; and &quot;total_oxidators&quot;
        -total amount of electrons available for reduction [mmol e-/l]
        -total amount of electrons needed for oxidation [mmol e-/l]
include: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean
    verbose flag (default False)
</code></pre></div>
<h6 id="mibiscreen.analysis.sample.screening_NA.electron_balance--output">Output</h6>
<div class="highlight"><pre><span></span><code>e_bal : pd.Series
    Ratio of electron availability: electrons available for reduction
    devided by electrons needed for oxidation
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/sample/screening_NA.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="k">def</span><span class="w"> </span><span class="nf">electron_balance</span><span class="p">(</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">include</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="p">):</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculating electron balance between reductors and oxidators.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    Determines ratio between the amount of electrons available and those</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    needed for oxidation of the contaminants based on values determined by</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    the routines &quot;reductors()&quot; and &quot;oxidators()&quot;.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    Ratio higher then one indicates sufficient electrons available for degredation,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    values smaller 1 indicates not sufficient supply of electrons to reduce</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    the present amount of contaminants.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    Input</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    -----</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        data_frame: pd.DataFrame</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">            tabular data containinng &quot;total_reductors&quot; and &quot;total_oxidators&quot;</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">                -total amount of electrons available for reduction [mmol e-/l]</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">                -total amount of electrons needed for oxidation [mmol e-/l]</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        include: bool, default False</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            verbose flag (default False)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">    Output</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">    ------</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        e_bal : pd.Series</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            Ratio of electron availability: electrons available for reduction</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            devided by electrons needed for oxidation</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;electron_balance()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="c1">### check on correct data input format and extracting column names as list</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="n">include</span><span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="k">if</span> <span class="n">names</span><span class="o">.</span><span class="n">name_total_reductors</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="n">tot_reduct</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_total_reductors</span><span class="p">]</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="n">tot_reduct</span> <span class="o">=</span> <span class="n">reductors</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="k">if</span> <span class="n">names</span><span class="o">.</span><span class="n">name_total_oxidators</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="n">tot_oxi</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_total_oxidators</span><span class="p">]</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="n">tot_oxi</span> <span class="o">=</span> <span class="n">oxidators</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="n">e_bal</span> <span class="o">=</span> <span class="n">tot_reduct</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">tot_oxi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="n">e_bal</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">name_e_balance</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="k">if</span> <span class="n">include</span><span class="p">:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_e_balance</span><span class="p">]</span> <span class="o">=</span> <span class="n">e_bal</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Electron balance e_red/e_cont is:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e_bal</span><span class="p">))</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="k">return</span> <span class="n">e_bal</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.sample.screening_NA.oxidators" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">oxidators</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">contaminant_group</span><span class="o">=</span><span class="s1">&#39;BTEXIIN&#39;</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate the amount of electron oxidators [mmol e-/l].</p>
<p>Calculates the amount of electrons needed for oxidation of the contaminants.
It transformes the concentrations of contaminants to molar concentrations using
molecular masses in [mg/mmol] and further identifies number of electrons from
the chemical reactions using stiochiometric ratios</p>
<p>alternatively: based on nitrogen and phosphate availability</p>
<h6 id="mibiscreen.analysis.sample.screening_NA.oxidators--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    Contaminant contentrations in [ug/l], i.e. microgram per liter
contaminant_group: str
    Short name for group of contaminants to use
    default is &#39;BTEXIIN&#39; (for benzene, toluene, ethylbenzene, xylene,
                          indene, indane and naphthaline)
inplace: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean
    verbose flag (default False)
</code></pre></div>
<h6 id="mibiscreen.analysis.sample.screening_NA.oxidators--output">Output</h6>
<div class="highlight"><pre><span></span><code>tot_oxi: pd.Series
    Total amount of electrons oxidators in [mmol e-/l]
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/sample/screening_NA.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="k">def</span><span class="w"> </span><span class="nf">oxidators</span><span class="p">(</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="n">contaminant_group</span> <span class="o">=</span> <span class="s2">&quot;BTEXIIN&quot;</span><span class="p">,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">include</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="p">):</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the amount of electron oxidators [mmol e-/l].</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    Calculates the amount of electrons needed for oxidation of the contaminants.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    It transformes the concentrations of contaminants to molar concentrations using</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    molecular masses in [mg/mmol] and further identifies number of electrons from</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    the chemical reactions using stiochiometric ratios</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    alternatively: based on nitrogen and phosphate availability</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">    Input</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    -----</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            Contaminant contentrations in [ug/l], i.e. microgram per liter</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        contaminant_group: str</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">            Short name for group of contaminants to use</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            default is &#39;BTEXIIN&#39; (for benzene, toluene, ethylbenzene, xylene,</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">                                  indene, indane and naphthaline)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        inplace: bool, default False</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            verbose flag (default False)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    Output</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    ------</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        tot_oxi: pd.Series</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">            Total amount of electrons oxidators in [mmol e-/l]</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;oxidators()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="c1">### check on correct data input format and extracting column names as list</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="n">include</span><span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="c1">### sorting out which columns in data to use for summation of electrons available</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">quantities</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">determine_quantities</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span><span class="n">name_list</span> <span class="o">=</span> <span class="n">contaminant_group</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">tot_oxi</span> <span class="o">=</span> <span class="mf">0.</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">quantities</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>            <span class="n">cm_cont</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span><span class="o">*</span> <span class="mf">0.001</span><span class="o">/</span><span class="n">properties</span><span class="p">[</span><span class="n">cont</span><span class="p">][</span><span class="s1">&#39;molecular_mass&#39;</span><span class="p">]</span> <span class="c1"># molar concentration in mmol/l</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="n">tot_oxi</span> <span class="o">+=</span> <span class="n">cm_cont</span> <span class="o">*</span>  <span class="n">properties</span><span class="p">[</span><span class="n">cont</span><span class="p">][</span><span class="s1">&#39;factor_stoichiometry&#39;</span><span class="p">]</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data not in standardized format. Run &#39;standardize()&#39; first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="n">tot_oxi</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_total_oxidators</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total amount of oxidators per well in [mmol e-/l] is:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tot_oxi</span><span class="p">))</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="c1">### additing series to data frame</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">if</span> <span class="n">include</span><span class="p">:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_total_oxidators</span><span class="p">]</span> <span class="o">=</span> <span class="n">tot_oxi</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="k">return</span> <span class="n">tot_oxi</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.sample.screening_NA.reductors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reductors</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">ea_group</span><span class="o">=</span><span class="s1">&#39;ONS&#39;</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate the amount of electron reductors [mmol e-/l].</p>
<p>It determines the amount of electrons availble from electron acceptors
(default: mobile dissolved oxygen, nitrate, and sulfate).</p>
<p>It relates concentrations to electrons using the stochimetry from the
chemical reactions producting electrons and the molecular mass values
for the quantities in [mg/mmol].</p>
<h6 id="mibiscreen.analysis.sample.screening_NA.reductors--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    concentration values of electron acceptors in [mg/l]
ea_group: str
    Short name for group of electron acceptors to use
    default is &#39;ONS&#39; (for oxygen, nitrate, and sulfate)
include: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean
    verbose flag (default False)
</code></pre></div>
<h6 id="mibiscreen.analysis.sample.screening_NA.reductors--output">Output</h6>
<div class="highlight"><pre><span></span><code>tot_reduct: pd.Series
Total amount of electrons needed for reduction in [mmol e-/l]
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/sample/screening_NA.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="k">def</span><span class="w"> </span><span class="nf">reductors</span><span class="p">(</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">ea_group</span> <span class="o">=</span> <span class="s1">&#39;ONS&#39;</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">include</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="p">):</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the amount of electron reductors [mmol e-/l].</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    It determines the amount of electrons availble from electron acceptors</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    (default: mobile dissolved oxygen, nitrate, and sulfate).</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    It relates concentrations to electrons using the stochimetry from the</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    chemical reactions producting electrons and the molecular mass values</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    for the quantities in [mg/mmol].</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Input</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    -----</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">            concentration values of electron acceptors in [mg/l]</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        ea_group: str</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            Short name for group of electron acceptors to use</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">            default is &#39;ONS&#39; (for oxygen, nitrate, and sulfate)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        include: bool, default False</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">            verbose flag (default False)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    Output</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    ------</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        tot_reduct: pd.Series</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        Total amount of electrons needed for reduction in [mmol e-/l]</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;reductors()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="c1">### check on correct data input format and extracting column names as list</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="n">include</span><span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="c1">### sorting out which columns in data to use for summation of electrons available</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">quantities</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">determine_quantities</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span><span class="n">name_list</span> <span class="o">=</span> <span class="n">ea_group</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="c1">### actually performing summation</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">tot_reduct</span> <span class="o">=</span> <span class="mf">0.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="k">for</span> <span class="n">ea</span> <span class="ow">in</span> <span class="n">quantities</span><span class="p">:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>            <span class="n">tot_reduct</span> <span class="o">+=</span> <span class="n">properties</span><span class="p">[</span><span class="n">ea</span><span class="p">][</span><span class="s1">&#39;factor_stoichiometry&#39;</span><span class="p">]</span><span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="n">ea</span><span class="p">]</span><span class="o">/</span><span class="n">properties</span><span class="p">[</span><span class="n">ea</span><span class="p">][</span><span class="s1">&#39;molecular_mass&#39;</span><span class="p">]</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data not in standardized format. Run &#39;standardize()&#39; first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">tot_reduct</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_total_reductors</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total amount of electron reductors per well in [mmol e-/l] is:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tot_reduct</span><span class="p">))</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="c1">### additing series to data frame</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="k">if</span> <span class="n">include</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_total_reductors</span><span class="p">]</span> <span class="o">=</span> <span class="n">tot_reduct</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="k">return</span> <span class="n">tot_reduct</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.sample.screening_NA.sample_NA_screening" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sample_NA_screening</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">ea_group</span><span class="o">=</span><span class="s1">&#39;ONS&#39;</span><span class="p">,</span> <span class="n">contaminant_group</span><span class="o">=</span><span class="s1">&#39;BTEXIIN&#39;</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Screening of NA potential for each sample in one go.</p>
<p>Determines for each sample, the availability of electrons for (bio)degradation of
contaminants from concentrations of (mobile dissolved) electron acceptors
(default: oxygen, nitrate, sulfate). It puts them into relation to electrons
needed for degradation using contaminant concentrations. Resulting electron
balance is linked to a color flag/traffic light indicating status:
    - green: amount of electrons available for (bio-)degradation is higher than
             amount needed for degrading present contaminant mass/concentration
        &ndash;&gt; potential for natural attenuation
    - yellow: electron balance unknown because data is not sufficient
        &ndash;&gt; more information needed
    - red: amount of electrons available for (bio-)degradation is lower than
             amount needed for degrading present contaminant mass/concentration
        &ndash;&gt; limited potential for natural attenuation</p>
<div class="highlight"><pre><span></span><code>Sufficient supply of electrons is a prerequite for biodegradation and thus the
</code></pre></div>
<p>potential of natural attenuation (NA) as remediation strategy.
Input</p>
<hr />
<div class="highlight"><pre><span></span><code>data_frame: pd.DataFrame
    Concentration values of
        - electron acceptors in [mg/l]
        - contaminants in [ug/l]
ea_group: str, default &#39;ONS&#39;
    Short name for group of electron acceptors to use
    &#39;ONS&#39; stands for oxygen, nitrate, sulfate and ironII
contaminant_group: str, default &#39;BTEXIIN&#39;
    Short name for group of contaminants to use
    &#39;BTEXIIN&#39; stands for benzene, toluene, ethylbenzene, xylene,
                           indene, indane and naphthaline
include: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean, default False
    verbose flag
</code></pre></div>
<h6 id="mibiscreen.analysis.sample.screening_NA.sample_NA_screening--output">Output</h6>
<div class="highlight"><pre><span></span><code>na_data: pd.DataFrame
    Tabular data with all quantities of NA screening listed per sample
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/sample/screening_NA.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="k">def</span><span class="w"> </span><span class="nf">sample_NA_screening</span><span class="p">(</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="n">ea_group</span> <span class="o">=</span> <span class="s1">&#39;ONS&#39;</span><span class="p">,</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">contaminant_group</span> <span class="o">=</span> <span class="s2">&quot;BTEXIIN&quot;</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="n">include</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="p">):</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Screening of NA potential for each sample in one go.</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    Determines for each sample, the availability of electrons for (bio)degradation of</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    contaminants from concentrations of (mobile dissolved) electron acceptors</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    (default: oxygen, nitrate, sulfate). It puts them into relation to electrons</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">    needed for degradation using contaminant concentrations. Resulting electron</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">    balance is linked to a color flag/traffic light indicating status:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        - green: amount of electrons available for (bio-)degradation is higher than</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">                 amount needed for degrading present contaminant mass/concentration</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">            --&gt; potential for natural attenuation</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        - yellow: electron balance unknown because data is not sufficient</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">            --&gt; more information needed</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        - red: amount of electrons available for (bio-)degradation is lower than</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">                 amount needed for degrading present contaminant mass/concentration</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            --&gt; limited potential for natural attenuation</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">        Sufficient supply of electrons is a prerequite for biodegradation and thus the</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    potential of natural attenuation (NA) as remediation strategy.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">    Input</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    -----</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">        data_frame: pd.DataFrame</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">            Concentration values of</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">                - electron acceptors in [mg/l]</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">                - contaminants in [ug/l]</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        ea_group: str, default &#39;ONS&#39;</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">            Short name for group of electron acceptors to use</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">            &#39;ONS&#39; stands for oxygen, nitrate, sulfate and ironII</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        contaminant_group: str, default &#39;BTEXIIN&#39;</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            Short name for group of contaminants to use</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            &#39;BTEXIIN&#39; stands for benzene, toluene, ethylbenzene, xylene,</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">                                   indene, indane and naphthaline</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        include: bool, default False</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        verbose: Boolean, default False</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">            verbose flag</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">    Output</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    ------</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        na_data: pd.DataFrame</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">            Tabular data with all quantities of NA screening listed per sample</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;sample_NA_screening()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="c1">### check on correct data input format and extracting column names as list</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="n">data</span><span class="p">,</span><span class="n">_</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="n">include</span><span class="p">)</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="n">tot_reduct</span> <span class="o">=</span> <span class="n">reductors</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>                           <span class="n">ea_group</span> <span class="o">=</span> <span class="n">ea_group</span><span class="p">,</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>                           <span class="n">include</span> <span class="o">=</span> <span class="n">include</span><span class="p">,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>                           <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="n">tot_oxi</span> <span class="o">=</span> <span class="n">oxidators</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>                        <span class="n">contaminant_group</span> <span class="o">=</span> <span class="n">contaminant_group</span><span class="p">,</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>                        <span class="n">include</span> <span class="o">=</span> <span class="n">include</span><span class="p">,</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>                        <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="n">e_bal</span> <span class="o">=</span> <span class="n">electron_balance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>                             <span class="n">include</span> <span class="o">=</span> <span class="n">include</span><span class="p">,</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                             <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="n">na_traffic</span> <span class="o">=</span> <span class="n">sample_NA_traffic</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                            <span class="n">contaminant_group</span> <span class="o">=</span> <span class="n">contaminant_group</span><span class="p">,</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>                            <span class="n">include</span> <span class="o">=</span> <span class="n">include</span><span class="p">,</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>                            <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="n">list_new_quantities</span> <span class="o">=</span> <span class="p">[</span><span class="n">tot_reduct</span><span class="p">,</span><span class="n">tot_oxi</span><span class="p">,</span><span class="n">e_bal</span><span class="p">,</span><span class="n">na_traffic</span><span class="p">]</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="k">if</span> <span class="n">include</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>       <span class="n">na_data</span> <span class="o">=</span> <span class="n">extract_settings</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>       <span class="k">for</span> <span class="n">add</span> <span class="ow">in</span> <span class="n">list_new_quantities</span><span class="p">:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>           <span class="n">na_data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">na_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">add</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="n">na_data</span> <span class="o">=</span> <span class="n">data</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="k">return</span> <span class="n">na_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiscreen.analysis.sample.screening_NA.sample_NA_traffic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sample_NA_traffic</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Evaluating availability of electrons for biodegredation interpreting electron balance.</p>
<p>Function builds on &lsquo;electron_balance()&rsquo;, based on electron availability
calculated from concentrations of contaminant and electron acceptors.</p>
<p>Sufficient supply of electrons is a prerequite for biodegradation and thus the
potential of natural attenuation (NA) as remediation strategy. The functions
interprets the electron balance giving it a traffic light of:
    - green: amount of electrons available for (bio-)degradation is higher than
             amount needed for degrading present contaminant mass/concentration
        &ndash;&gt; potential for natural attenuation
    - yellow: electron balance unknown because data is not sufficient
        &ndash;&gt; more information needed
    - red: amount of electrons available for (bio-)degradation is lower than
             amount needed for degrading present contaminant mass/concentration
        &ndash;&gt; limited potential for natural attenuation</p>
<h6 id="mibiscreen.analysis.sample.screening_NA.sample_NA_traffic--input">Input</h6>
<div class="highlight"><pre><span></span><code>data_frame: pd.DataFrame
    Ratio of electron availability
include: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean
    verbose flag (default False)
</code></pre></div>
<h6 id="mibiscreen.analysis.sample.screening_NA.sample_NA_traffic--output">Output</h6>
<div class="highlight"><pre><span></span><code>traffic : pd.Series
    Traffic light (decision) based on ratio of electron availability
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibiscreen/analysis/sample/screening_NA.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="k">def</span><span class="w"> </span><span class="nf">sample_NA_traffic</span><span class="p">(</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="n">include</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="p">):</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluating availability of electrons for biodegredation interpreting electron balance.</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    Function builds on &#39;electron_balance()&#39;, based on electron availability</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">    calculated from concentrations of contaminant and electron acceptors.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    Sufficient supply of electrons is a prerequite for biodegradation and thus the</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">    potential of natural attenuation (NA) as remediation strategy. The functions</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    interprets the electron balance giving it a traffic light of:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        - green: amount of electrons available for (bio-)degradation is higher than</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">                 amount needed for degrading present contaminant mass/concentration</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">            --&gt; potential for natural attenuation</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">        - yellow: electron balance unknown because data is not sufficient</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">            --&gt; more information needed</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        - red: amount of electrons available for (bio-)degradation is lower than</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">                 amount needed for degrading present contaminant mass/concentration</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">            --&gt; limited potential for natural attenuation</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    Input</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">    -----</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        data_frame: pd.DataFrame</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">            Ratio of electron availability</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        include: bool, default False</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">            verbose flag (default False)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    Output</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    ------</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        traffic : pd.Series</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            Traffic light (decision) based on ratio of electron availability</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;sample_NA_traffic()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="c1">### check on correct data input format and extracting column names as list</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="n">include</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="k">if</span> <span class="n">names</span><span class="o">.</span><span class="n">name_e_balance</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="n">e_balance</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_e_balance</span><span class="p">]</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="n">e_balance</span> <span class="o">=</span> <span class="n">electron_balance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="n">e_bal</span> <span class="o">=</span> <span class="n">e_balance</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="n">traffic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">e_bal</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="n">traffic</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">e_bal</span><span class="p">)]</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">NA_traffic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span><span class="n">names</span><span class="o">.</span><span class="n">name_na_traffic_light</span><span class="p">,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>                           <span class="n">data</span> <span class="o">=</span> <span class="n">traffic</span><span class="p">,</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>                           <span class="n">index</span> <span class="o">=</span> <span class="n">e_balance</span><span class="o">.</span><span class="n">index</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>                           <span class="p">)</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="k">if</span> <span class="n">include</span><span class="p">:</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_na_traffic_light</span><span class="p">]</span> <span class="o">=</span> <span class="n">NA_traffic</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Evaluation if natural attenuation (NA) is ongoing:&quot;</span><span class="p">)</span><span class="c1">#&quot; for {}&quot;.format(contaminant_group))</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Red light: Reduction is limited at </span><span class="si">{}</span><span class="s2"> out of </span><span class="si">{}</span><span class="s2"> locations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">traffic</span> <span class="o">==</span> <span class="s2">&quot;red&quot;</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">e_bal</span><span class="p">)))</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Green light: Reduction is limited at </span><span class="si">{}</span><span class="s2"> out of </span><span class="si">{}</span><span class="s2"> locations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">traffic</span> <span class="o">==</span> <span class="s2">&quot;green&quot;</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">e_bal</span><span class="p">)))</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yellow light: No decision possible at </span><span class="si">{}</span><span class="s2"> out of </span><span class="si">{}</span><span class="s2"> locations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">e_bal</span><span class="p">)),</span><span class="nb">len</span><span class="p">(</span><span class="n">e_bal</span><span class="p">)))</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="k">return</span> <span class="n">NA_traffic</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>


  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Alraune Zech, Sona Aseyednezhad, Robin Richardson, Jaro Camphuijsen
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/MiBiPreT/mibiscreen" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../assets/fontawesome.min.js"></script>
      
        <script src="../../assets/solid.min.js"></script>
      
        <script src="../../assets/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>